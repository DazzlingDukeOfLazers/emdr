<!DOCTYPE html>
<html>
    <head>
        <title>Audio Visualizer with Three.js</title>
        <style>
            body { margin: 0; }
            canvas { display: block; }
        </style>
        <script src="https://threejs.org/build/three.js"></script>
        <!-- The following script handles the movement of the sphere -->
        <script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
    </head>
    <body>
        <script>
            var scene, camera, renderer;
            var geometry, material, mesh;
            var targetX = 0, direction = 1;
            var heartFrequency = 0.1;
            var slider;
 
            function logSliderPosition(position) {
                var minp = 0;
                var maxp = 1;
                var minv = Math.log(0.1);
                var maxv = Math.log(10);
                var scale = (maxv-minv) / (maxp-minp);
                return Math.exp(minv + scale*(position-minp));
            }
            
            init();
            animate();
            
            function init() {
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
                
                renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize( window.innerWidth, window.innerHeight );
                document.body.appendChild( renderer.domElement );
 
                geometry = new THREE.SphereGeometry( 0.5, 32, 32 );
                material = new THREE.MeshBasicMaterial( { color: 0xff0000, wireframe: true } );
                
                mesh = new THREE.Mesh( geometry, material );
                scene.add( mesh );
                
                camera.position.z = 5;
                
                slider = document.createElement("input");
                slider.type = "range";
                slider.min = "0";
                slider.max = "1";
                slider.step = "0.01";
                slider.value = "0.5";
                slider.style.position = "absolute";
                slider.style.top = "10px";
                slider.style.left = "10px";
                document.body.appendChild(slider);
                
                slider.addEventListener("input", function() {
                    heartFrequency = logSliderPosition(this.value);
                }, false);
            }
 
            function animate() {
                requestAnimationFrame( animate );
                
                targetX += direction * heartFrequency * 0.01;
                
                if(targetX > 4) {
                    direction = -1;
                } else if(targetX < -4) {
                    direction = 1;
                }
                
                mesh.position.x = targetX;
 
                renderer.render( scene, camera );
            }
        </script>
    </body>
</html>
